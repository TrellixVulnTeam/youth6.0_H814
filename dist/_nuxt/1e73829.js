(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{487:function(e,t,n){"use strict";n.r(t);n(26),n(20),n(25),n(12),n(32),n(21),n(33);var r=n(5),o=n(10),c=(n(52),n(53),n(37),n(14));function m(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function l(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?m(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):m(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var d={props:{},data:function(){return{textarea:"",writeComment:!0,editCommentIdx:null,editCommentValue:null}},computed:l(l(l({},Object(c.e)({excavation:function(e){return e.excavationDetail}})),Object(c.c)(["isLoggedIn","getUserInfo","getExcavationDetail"])),{},{hasExcavationAnswer:function(){return!!this.getExcavationDetail.ans_con}}),methods:l(l({},Object(c.b)(["GET_EXCAVATION_DETAIL"])),{},{handleExcavation:function(e){var t=e.type;if(!this.isLoggedIn)return alert("로그인 해주세요.");if(!(this.getUserInfo.idx===this.getExcavationDetail.pro_user_idx))return alert("제안의 작성자만 수정 및 삭제를 할 수 있습니다.");if("remove"===t)return this.removeExcavation();var n="children"===this.$route.query.type?"/excavation-register?idx=".concat(this.$route.query.idx,"&type=children"):"/excavation-register?idx=".concat(this.$route.query.idx);this.$router.push(n)},handleEditComment:function(e){var t=e.type,n=e.comment;if("cancel"===t)return this.editCommentIdx=null,void(this.editCommentValue=null);this.updateComment({comment:n})},updateComment:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.comment,n.prev=1,n.next=4,t.$axios.$get("/commnet/update_comment_exc.do",{params:{idx:t.editCommentIdx,comment:t.editCommentValue,user_idx:t.getUserInfo.idx}});case 4:return n.sent,t.editCommentIdx=null,t.editCommentValue=null,n.next=9,t.GET_EXCAVATION_DETAIL({idx:t.$route.query.idx});case 9:n.next=13;break;case 11:n.prev=11,n.t0=n.catch(1);case 13:case"end":return n.stop()}}),n,null,[[1,11]])})))()},handleComment:function(e){var t=e.type,n=e.comment;return this.isLoggedIn?n.com_user_idx===this.getUserInfo.idx?"remove"===t?this.removeComment({comment:n}):void this.editComment({comment:n}):alert("댓글의 작성자만 삭제할 수 있습니다."):alert("로그인 해주세요.")},editComment:function(e){var t=e.comment;this.editCommentIdx=t.idx,this.editCommentValue=t.comment},removeComment:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=e.comment,n.prev=1,window.confirm("댓글을 삭제하시겠습니까?")){n.next=4;break}return n.abrupt("return");case 4:return n.next=6,t.$axios.$get("/commnet/delete_comment_exc.do",{params:{idx:r.idx,user_idx:t.getUserInfo.idx}});case 6:return n.next=8,t.GET_EXCAVATION_DETAIL({idx:t.$route.query.idx});case 8:n.next=13;break;case 10:n.prev=10,n.t0=n.catch(1),console.error(n.t0);case 13:case"end":return n.stop()}}),n,null,[[1,10]])})))()},removeExcavation:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!window.confirm("제안을 삭제하시겠습니까?")){t.next=15;break}if(!(e.getExcavationDetail.pro_user_idx!==e.getUserInfo.idx)){t.next=5;break}return t.abrupt("return",alert("제안의 작성자만 삭제할 수 있습니다."));case 5:return t.next=7,e.$axios.$get("/excavation/delete_excavation.do",{params:{idx:e.$route.query.idx,user_idx:e.getUserInfo.idx}});case 7:if(n=t.sent,r="children"===e.$route.query.type,o=r?"/excavation-list?type=children":"/excavation-list",!("string"==typeof n&&n.includes("삭제되었"))){t.next=15;break}return alert("제안이 삭제되었습니다."),e.$router.push(o),t.abrupt("return");case 15:t.next=20;break;case 17:t.prev=17,t.t0=t.catch(0),console.error(t.t0);case 20:case"end":return t.stop()}}),t,null,[[0,17]])})))()},addComment:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.textarea.length){t.next=2;break}return t.abrupt("return",alert("의견을 입력해주세요."));case 2:if(e.isLoggedIn){t.next=4;break}return t.abrupt("return",alert("로그인 해주세요"));case 4:return t.next=6,e.$axios.$get("/commnet/insert_comment_exc.do",{params:{comment:e.textarea,com_name:e.getUserInfo.user_name,com_user_idx:e.getUserInfo.idx,com_pro_idx:e.$route.query.idx}});case 6:if(n=t.sent,0,0!==n){t.next=12;break}return t.next=11,e.GET_EXCAVATION_DETAIL({idx:e.$route.query.idx});case 11:e.textarea="";case 12:case"end":return t.stop()}}),t)})))()},goPage:function(path){if("children"===this.$route.query.type)return this.$router.push("".concat(path,"?type=children"));this.$router.push(path)}})},x=n(17),component=Object(x.a)(d,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"suggest-comments"},[n("div",{staticClass:"btns"},[n("el-button",{staticClass:"first",on:{click:function(t){return e.handleExcavation({type:"edit"})}}},[e._v("\n      수정\n    ")]),e._v(" "),n("el-button",{staticClass:"second btn",on:{click:function(t){return e.handleExcavation({type:"remove"})}}},[e._v("\n      삭제\n    ")]),e._v(" "),n("el-button",{staticClass:"third",on:{click:function(t){return e.goPage("/excavation-list")}}},[e._v("\n      목록으로\n    ")])],1),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.hasExcavationAnswer,expression:"hasExcavationAnswer"}],staticClass:"suggest-answer"},[n("div",{staticClass:"title"},[e._v("\n      제안 답변\n    ")]),e._v(" "),n("div",{staticClass:"paragraph"},[e._v("\n      "+e._s(e.getExcavationDetail.ans_con)+"\n    ")])]),e._v(" "),e.writeComment?[n("section",{staticClass:"write-comment"},[n("el-input",{attrs:{type:"textarea",rows:4,placeholder:"의견을 달아주세요!"},model:{value:e.textarea,callback:function(t){e.textarea=t},expression:"textarea"}}),e._v(" "),n("el-button",{staticClass:"comment-btn",on:{click:e.addComment}},[e._v("\n        댓글 작성\n      ")])],1),e._v(" "),n("section",{staticClass:"comment-list"},[n("ul",e._l(e.excavation.comments,(function(t,r){return n("li",{key:r,staticClass:"comment"},[n("div",{staticClass:"comment-title"},[n("span",[e._v(e._s(t.com_name))]),e._v(" | "+e._s(t.editdate)+"\n          ")]),e._v(" "),e.editCommentIdx==t.idx?[n("el-input",{staticClass:"edit-comment",attrs:{type:"textarea",rows:4,placeholder:"의견을 달아주세요!"},model:{value:e.editCommentValue,callback:function(t){e.editCommentValue=t},expression:"editCommentValue"}})]:[n("div",{staticClass:"comment-text"},[e._v("\n              "+e._s(t.comment)+"\n            ")])],e._v(" "),e.editCommentIdx==t.idx?n("div",{staticClass:"comment-list__btns"},[n("el-button",{on:{click:function(n){return e.handleEditComment({type:"edit",comment:t})}}},[e._v("\n              수정완료\n            ")]),e._v(" "),n("el-button",{on:{click:function(n){return e.handleEditComment({type:"cancel",comment:t})}}},[e._v("\n              취소\n            ")])],1):n("div",{staticClass:"comment-list__btns"},[n("el-button",{on:{click:function(n){return e.handleComment({type:"edit",comment:t})}}},[e._v("\n              수정\n            ")]),e._v(" "),n("el-button",{on:{click:function(n){return e.handleComment({type:"remove",comment:t})}}},[e._v("\n              삭제\n            ")])],1)],2)})),0)]),e._v(" "),n("section",{staticClass:"go-list"})]:e._e()],2)}),[],!1,null,null,null);t.default=component.exports}}]);